# RAG Corp Pod Disruption Budgets
# Ensures high availability during node maintenance and cluster upgrades

# Backend PDB - always keep at least 1 pod running
# =============================================================================
# TARJETA CRC - infra/k8s/base/pdb.yaml
# =============================================================================
# Responsabilidades:
# - Proteger disponibilidad minima durante mantenimientos.
#
# Colaboradores:
# - infra/k8s/base/backend-deployment.yaml
# - infra/k8s/base/frontend-deployment.yaml
#
# Invariantes:
# - Selectores deben coincidir con Deployments.
# =============================================================================

apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: ragcorp-backend-pdb
  namespace: ragcorp
  labels:
    app.kubernetes.io/name: ragcorp
    app.kubernetes.io/component: backend
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: ragcorp
      app.kubernetes.io/component: backend
---
# Frontend PDB - always keep at least 1 pod running
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: ragcorp-frontend-pdb
  namespace: ragcorp
  labels:
    app.kubernetes.io/name: ragcorp
    app.kubernetes.io/component: frontend
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: ragcorp
      app.kubernetes.io/component: frontend
