# ============================================
# RAG Corp - Environment Configuration
# ============================================
# Copy this file to .env and fill in your values.
# All variables with (required) MUST be set.

# ============================================
# REQUIRED - Application will fail without these
# ============================================

# PostgreSQL connection string (required)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://raguser:ragpass@localhost:5432/ragcorp

# Google Gemini API Key (required)
# Get yours at: https://makersuite.google.com/app/apikey
GOOGLE_API_KEY=your_api_key_here

# ============================================
# OPTIONAL - Defaults shown in parentheses
# ============================================

# ============================================
# DATABASE - Connection Pool
# ============================================

# Minimum connections in pool (default: 2)
DB_POOL_MIN_SIZE=2

# Maximum connections in pool (default: 10)
DB_POOL_MAX_SIZE=10

# Statement timeout in milliseconds (default: 30000 = 30s)
# Queries exceeding this are cancelled
DB_STATEMENT_TIMEOUT_MS=30000

# ============================================
# CORS
# ============================================

# CORS allowed origins, comma-separated (default: http://localhost:3000)
# Example for production: https://app.example.com,https://admin.example.com
ALLOWED_ORIGINS=http://localhost:3000

# ============================================
# CHUNKING CONFIGURATION
# ============================================

# Characters per chunk (default: 900)
# Larger = more context per chunk, but less specific retrieval
CHUNK_SIZE=900

# Overlap between consecutive chunks (default: 120)
# Must be: 0 <= CHUNK_OVERLAP < CHUNK_SIZE
# Higher overlap preserves more context at chunk boundaries
CHUNK_OVERLAP=120

# ============================================
# API LIMITS
# ============================================

# Maximum top_k for /v1/query and /v1/ask (default: 20)
MAX_TOP_K=20

# Maximum characters for document text in /v1/ingest/text (default: 100000)
MAX_INGEST_CHARS=100000

# Maximum characters for query in /v1/query and /v1/ask (default: 2000)
MAX_QUERY_CHARS=2000

# Maximum characters for document title (default: 200)
MAX_TITLE_CHARS=200

# Maximum characters for source URL (default: 500)
MAX_SOURCE_CHARS=500

# ============================================
# OBSERVABILITY
# ============================================

# Enable OpenTelemetry tracing (default: false/0)
# When enabled, traces are exported to console (dev) or OTLP endpoint (prod)
OTEL_ENABLED=0

# OpenTelemetry OTLP endpoint (only used if OTEL_ENABLED=1)
# Example for Jaeger: http://localhost:4317
# Example for Honeycomb: https://api.honeycomb.io
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# ============================================
# SECURITY - API KEY AUTHENTICATION
# ============================================

# API keys configuration (JSON format)
# Format: {\"key\": [\"scope1\", \"scope2\"], ...}
# Scopes: \"ingest\" (POST /v1/ingest/*), \"ask\" (POST /v1/query, /v1/ask), \"metrics\" (/metrics)
# Example with multiple keys:
# API_KEYS_CONFIG={\"prod-ingest-key\":[\"ingest\"],\"prod-query-key\":[\"ask\"],\"admin-key\":[\"ingest\",\"ask\",\"metrics\"]}
API_KEYS_CONFIG=

# Require authentication for /metrics endpoint (default: false)
METRICS_REQUIRE_AUTH=false

# ============================================
# SECURITY - RATE LIMITING
# ============================================

# Rate limit: requests per second per API key (default: 10)
RATE_LIMIT_RPS=10

# Rate limit: maximum burst tokens (default: 20)
# Allows short bursts up to this many requests before throttling
RATE_LIMIT_BURST=20

# ============================================
# SECURITY - HARDENING
# ============================================

# Maximum request body size in bytes (default: 10485760 = 10MB)
MAX_BODY_BYTES=10485760

# CORS: Allow credentials (cookies/auth headers) cross-origin (default: false)
# Only enable if frontend needs to send cookies
CORS_ALLOW_CREDENTIALS=false

# ============================================
# RAG QUALITY
# ============================================

# Prompt template version (default: v1)
# Available: v1 (Spanish with injection defense)
# Templates located in backend/app/prompts/
PROMPT_VERSION=v1

# Maximum context characters sent to LLM (default: 12000)
# Prevents token overflow; typical chunk is ~900 chars
# 12000 chars â‰ˆ 10-13 chunks depending on metadata
MAX_CONTEXT_CHARS=12000
